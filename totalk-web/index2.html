<!DOCTYPE html>
<html>

<script type="text/javascript" src="thrift/thrift.js">
</script>

<script type="text/javascript" src="thrift/knock-thrift.js">
</script>

<script type="text/javascript" src="thrift/services/types_types.js">
</script>

<script type="text/javascript" src="thrift/services/exceptions_types.js">
</script>

<script type="text/javascript" src="thrift/services/TotalkService_types.js">
</script>

<script type="text/javascript" src="thrift/services/TotalkService.js">
</script>

<script type="text/javascript" src="thrift/services/ClientService_types.js">
</script>

<script type="text/javascript" src="thrift/services/ClientService.js">
</script>

<head>
    <title></title>
</head>
<body>

    <script type="text/javascript">

        var wsUrl = "ws://localhost:12000/thrift_js?userId=123&deviceId=2";
        var xhrUrl = "http://localhost:12000/TJSON?userId=123&deviceId=2";
        var transport_ = new knock.thrift.TKnockTransport(wsUrl, xhrUrl);
        transport_.open();

        var service = new totalk.thrift.TotalkServiceClient(new Thrift.Protocol(transport_));


        Thrift.AsyncManager.getInstance().addClientCallback('ClientService:onPing', function(arg){
            log("onPing: " + arg);
            return true;
        });

        window.sendPing = function(){
            service.ping("hi2");
        }

        window.log = function(arg){
            var div = document.createElement("div");
            div.appendChild(document.createTextNode(arg));
            document.getElementById("log").appendChild(div);
            return true;
        }

    </script>


    <button onclick="window.sendPing()">ping</button>

    <div id="log"></div>
</body>
</html>